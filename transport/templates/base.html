<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %} {% endblock %} | Transport </title>
    <style>
    </style>
</head>
<body>
    <nav>
        <a href="{{ url_for('home.index') }}">Home</a>
        {% if current_user.is_authenticated %}
            <p>Logged in as {{ current_user.firstname }} {{ current_user.lastname }} </p>
            <button id="logout" href="{{ url_for('api.authentication_api.logout') }}">Logout</button>
        {% else %}
            <p>Not logged in</p>
            <a href="{{ url_for('authentication.login') }}" class="btn btn-primary">Login</a>
            <a href="{{ url_for('authentication.register') }}" class="btn btn-primary">Register</a>
            {% endif %}
    </nav>
    <hr>
    <div class="content">
        {% block content %} {% endblock %}
    </div>
</body>
</html>

{% block js %}
    <script>
        const logout = document.getElementById("logout")
        logout.addEventListener("click", async (e) => {
            e.preventDefault();
            const response = await fetch("{{ url_for('api.authentication_api.logout') }}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: {}
            });
            if(response.ok) {
                const json = await response.json();
                window.location.href = "{{ url_for('home.index') }}";
            } else {
                const json = await response.json();
                alert(json.message);
            }
        });
    </script>
{% endblock %}