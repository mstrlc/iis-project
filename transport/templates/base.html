<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %} {% endblock %} | Transport </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
    </style>
</head>
<body>
    <nav>
        <a href="{{ url_for('home.index') }}">Home</a>
        <a href="{{ url_for('administration.users') }}">Administration</a>
        {% if current_user.is_authenticated %}
            <p>Logged in as {{ current_user.firstname }} {{ current_user.lastname }} â€“ {{ current_user.email }} </p>
            <button id="logout" href="{{ url_for('api.authentication_api.logout') }}">Logout</button>
        {% else %}
            <p>Not logged in</p>
            <a href="{{ url_for('authentication.login') }}" class="btn">Login</a>
            <a href="{{ url_for('authentication.register') }}" class="btn">Register</a>
            {% endif %}
    </nav>
    <hr>
    <div class="content">
        <div class="container">
            <h1> {{ self.title() }} </h1>
            {% block content %} {% endblock %}
        </div>
    </div>
</body>
</html>

{% block logout %}
    <script>
        const logout = document.getElementById("logout")
        logout.addEventListener("click", async (e) => {
            e.preventDefault();
            const response = await fetch("{{ url_for('api.authentication_api.logout') }}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: {}
            });
            if(response.ok) {
                const json = await response.json();
                window.location.href = "{{ url_for('home.index') }}";
            } else {
                const json = await response.json();
                alert(json.message);
            }
        });
    </script>
{% endblock %}

{% block js %} {% endblock %}